<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.camperxoffice.stock.dao.stockDao">

    <resultMap type= "com.vo.stock.StockVO" id="StockMap">
        <result column="PRD_CODE" property="prdCode"/>
        <result column="STOCK_SEQ" property="stockSeq"/>
        <result column="STOCK_DATE" property="stockDate"/>
        <result column="PRICE" property="price"/>
        <result column="PRD_QTY" property="prdQty"/>
        <result column="STOCK_STATUS" property="stockStatus"/>
        <result column="PRD_NAME" property="prdName"/>
        <result column="SAFETY_STOCK" property="safetyStock"/>
        <result column="NOTES" property="notes"/>
        <result column="IN_CHATGE" property="inChatge"/>
        <result column="PURCHASE_QTY" property="purchaseQty"/>
    </resultMap>

    <resultMap id="catMap" type="com.vo.category.CatVO">
        <result column="CAT_CODE" property="catCode"/>
        <result column="CAT_NAME" property="catName"/>
        <result column="CAT_LV" property="catLv"/>
        <result column="CAT_UPLV" property="catUplv"/>
        <result column="DEL_STATUS" property="delStatus"/>
        <result column="CAT_INDATE" property="catIndate"/>
    </resultMap>

    <resultMap id="prdMap" type="com.vo.product.PrdVO">
        <result column="PRD_CODE" property="prdCode"/>
        <result column="PRD_NAME" property="prdName"/>
        <result column="PRD_COLOR" property="prdColor"/>
        <result column="PRICE" property="price"/>
        <result column="PRD_DESC" property="prdDesc"/>
        <result column="PRD_IMG" property="prdImg"/>
        <result column="SAFETY_STOCK" property="safetyStock"/>
        <result column="CAT_CODE" property="catCode"/>
        <result column="PRD_QTY" property="prdQty"/>
        <result column="CAT_NAME" property="catName"/>
        <result column="PRD_STATUS" property="prdStatus"/>
    </resultMap>
    <select id="selectCatList" resultMap="catMap">
        SELECT
            CAT_CODE,
            CAT_NAME,
            CAT_LV,
            CAT_UPLV,
            DEL_STATUS,
            CAT_INDATE
        FROM CAT_INFO
        WHERE 1=1
        <if test="catUplv != null and catUplv !='' ">
            AND CAT_UPLV = #{catUplv}
        </if>
        ORDER BY CAT_NAME
    </select>

    <insert id="SavePrdInfo">
        INSERT INTO PRD_INFO (
            PRD_NAME, PRD_CODE, PRICE, PRD_COLOR,
            PRD_QTY, PRD_DESC, PRD_IMG, SAFETY_STOCK, CAT_CODE
        )
        VALUES (
                   #{prdName}, #{prdCode}, #{price}, #{prdColor},
                #{prdQty}, #{prdDesc}, #{prdImg}, #{safetyStock}, #{catCode}
               )
    </insert>
    <select id="setStockList" resultMap="prdMap">
        SELECT
            PRD_CODE,
            PRD_NAME,
            CAT_CODE,
            PRICE,
            PRD_STATUS
        FROM PRD_INFO
        WHERE 1=1
    </select>

    <select id="setStockListinfo" resultMap="StockMap">
        SELECT
            A.PRD_CODE,
            B.PRD_NAME,
            A.PRD_QTY,
            B.SAFETY_STOCK,
            A.STOCK_STATUS
        FROM STOCK_INFO A
        JOIN PRD_INFO B
        ON A.PRD_CODE = B.PRD_CODE
        WHERE 1 = 1
    </select>

    <select id="setStockDateLog" resultMap="StockMap">
        SELECT
            A.STOCK_DATE,
            A.PRD_CODE,
            B.PRD_NAME,
            C.PURCHASE_QTY,
            D.IN_CHATGE,
            A.NOTES
        FROM STOCK_INFO A
             JOIN PRD_INFO B ON A.PRD_CODE = B.PRD_CODE
             JOIN PURCHASE_INFO C ON A.PRD_CODE = C.PRD_CODE
             JOIN VENDOR_INFO D ON C.VENDOR_CODE = D.VENDOR_CODE
    </select>

</mapper>
